<div metal:use-macro="_LAYOUT">
<div metal:fill-slot="content">
  <div tal:condition="prev_next">
    <hr>
    <div tal:replace="structure prev_next"></div>
    <hr>
  </div>

  <p>Submitted ${_pd(submission.created_at)}</p>
  <div tal:condition="submission.verified_at">
    <p>Submission verified ${_pd(submission.verified_at)}</p>
    <pre>${submission.verification_results}</pre>
  </div>

  <div tal:condition="submission.made_at">
    <p>Submission made ${_pd(submission.made_at)}</p>
    <pre>${submission.make_results}</pre>
  </div>

  <div tal:condition="missing">
    <div tal:repeat="missing_files sorted(missing.keys(), key=lambda s: sorted(list(s)))">
      <h3 style="color:red">Failed tests due to missing '<code>${", ".join(sorted(list(missing_files)))}</code>' ${_ap(_ss(missing[missing_files]))}</h3>
      <ul>
	<li tal:repeat="test sorted(missing[missing_files])">
	  ${test.name} ${_ap(test.points)}
	</li>
      </ul>
    </div>
  </div>

  <div tal:replace="structure diff_table"></div>

  <a tal:condition="request.user.is_admin_for_submission(submission)"
     href="${_R('zipfile_download', submission_id=submission.id)}">
    Download submission zipfile
  </a>
     
</div>
</div>
