<div metal:use-macro="_LAYOUT">
<div metal:fill-slot="content">
  <h1>Student Submissions Overview</h1>
  <p>Info for <a href="${_R('class_item', class_name=project.class_.name)}">${project.class_.name}</a> ${project.name}
    (<a href="${_R('project_edit', project_id=project.id)}">edit</a>)</p>

  <p>Make a submission via <code>~bboe/bin/submit -p ${project.class_.name}:${project.id} ${project.submit_string()}</code></p>

  <div tal:condition="recent_submissions"><h3>Most recent submissions</h3>
    <ul>
      <li tal:repeat="submission recent_submissions">
	<a href="${_R('submission_item', submission_id=submission.id)}">
	  ${submission.created_at}</a> by ${submission.user.name}
      </li>
    </ul>
  </div>

  <div tal:condition="submissions">
    <table border="1">
      <tr>
	<th>Student</th>
	<th>Submissions (Most Recent Three Shown)</th>
      </tr>
      <tr tal:repeat="(user, user_submissions) submissions">
	<td>
	  <a href="${_R('user_item', username=user.username)}">
	    ${user.name}</a>
	</td>
	<td>
	  <ul tal:condition="user_submissions">
	    <li tal:repeat="user_submission user_submissions">
	      <a href="${_R('submission_item', submission_id=user_submission.id)}">
		${user_submission.created_at}</a>
	    </li>
	    <li tal:condition="user in user_truncated">
	      <a href="${_R('project_item_detailed', class_name=request.matchdict['class_name'], project_id=request.matchdict['project_id'], username=user.username)}">
		See all submissions...</a>
	    </li>
	  </ul>
	</td>
      </tr>
    </table>
  </div>
  <p tal:condition="not submissions">
    No students have submitted anything for ${project.name}
  </p>
</div>
</div>
