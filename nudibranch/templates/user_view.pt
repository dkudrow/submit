<div metal:use-macro="_LAYOUT">
<div metal:fill-slot="content">
  <h3>${name}</h3>
  <div tal:condition="classes_taking">
    <h4>Member of</h4>
    <ul>
      <li tal:repeat="class_ classes_taking">
	<a href="${_R('class_item', class_name=class_.name)}">${class_.name}</a>
      </li>
    </ul>
  </div>
  <div tal:condition="not classes_taking">
    <p>You are not a member of any classes. (<a href="${_R('class_join_list')}">Join Classes</a>)</p>
  </div>
  <div tal:condition="user_subs">
    <h4>Most recent submissions</h4>
    <table>
      <tr><th>Class</th><th>Project</th><th>Sub Info</th></tr>
      <tr tal:repeat="sub user_subs">
        <td><a href="${_R('class_item', class_name=sub.project.class_.name)}">${sub.project.class_.name}</a></td>
        <td tal:define="class_admin sub.project.class_.is_admin(request.user)">
          <a tal:condition="class_admin" href="${_R('project_item_summary', class_name=sub.project.class_.name, project_id=sub.project.id)}">${sub.project.name}</a>
          <a tal:condition="not class_admin" href="${_R('project_item_detailed_user', class_name=sub.project.class_.name, project_id=sub.project.id, username=request.user.username)}">${sub.project.name}</a>
        </td>
        <td>${structure: sub.time_score(request)}</td>
      </tr>
    </table>
  </div>
  <div tal:condition="admin_classes">
    <h4>Administrator of</h4>
    <ul>
      <li tal:repeat="class_ admin_classes">
	<a href="${_R('class_item', class_name=class_.name)}">${class_.name}</a>
        <span tal:condition="class_.is_locked">(Locked)</span>
      </li>
    </ul>
  </div>
  <div tal:condition="admin_subs">
    <h4>Classes' recent submissions</h4>
    <table>
      <tr><th>Class</th><th>Project</th><th>Group</th><th>Sub Info</th></tr>
      <tr tal:repeat="sub admin_subs">
        <td><a href="${_R('class_item', class_name=sub.project.class_.name)}">${sub.project.class_.name}</a></td>
        <td><a href="${_R('project_item_summary', class_name=sub.project.class_.name, project_id=sub.project.id)}">${sub.project.name}</a></td>
        <td>${sub.group.users_str}</td>
        <td>${structure: sub.time_score(request, admin=True)}</td>
      </tr>
    </table>
  </div>
</div>
</div>
